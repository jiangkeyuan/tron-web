{"version":3,"file":"index.605635a7.js","sources":["../../src/page/buyer/sale-record/index.vue"],"sourcesContent":["<template>\n  <el-form :model=\"form\" inline class=\"sale-record sale-record-search\">\n    <el-form-item label=\"订单号\">\n      <el-input v-model=\"form.orderNo\" />\n    </el-form-item>\n    <el-form-item label=\"接收\">\n      <el-input v-model=\"form.toAddress\" />\n    </el-form-item>\n    <el-form-item label=\"时间\">\n      <el-date-picker v-model=\"form.date\" type=\"datetimerange\" range-separator=\"To\" start-placeholder=\"Start date\"\n        end-placeholder=\"End date\" />\n    </el-form-item>\n    <el-form-item label=\"Api Key\">\n      <el-input v-model=\"form.apikey\" />\n    </el-form-item>\n    <el-form-item>\n      <el-button @click=\"reset\">重置</el-button>\n      <el-button type=\"primary\" color=\"#294aa5\" @click=\"seach\">查询</el-button>\n    </el-form-item>\n  </el-form>\n  <div class=\"sale-record sale-record-table\">\n    <el-radio-group v-model=\"form.orderStatus\" class=\"sale-record-group\" @change=\"seach\">\n      <el-radio-button label=\"\">全部</el-radio-button>\n      <el-radio-button label=\"WAIT_DELEGATE\">待代理</el-radio-button>\n      <el-radio-button label=\"DELEGATEING\">代理中</el-radio-button>\n      <el-radio-button label=\"ALMOST_DONE\">即将结束</el-radio-button>\n      <el-radio-button label=\"DONE\">已完成</el-radio-button>\n      <el-radio-button label=\"UNAVAILABLE\">未生效</el-radio-button>\n    </el-radio-group>\n\n    <el-table :data=\"tableData\" stripe class=\"sale-record-table-list\">\n      <el-table-column prop=\"orderNo\" label=\"订单号\" width=\"220\" />\n      <el-table-column prop=\"toAddress\" label=\"接收\" width=\"180\" />\n      <el-table-column prop=\"rentalQuantity\" label=\"租用量\" width=\"120\" />\n      <el-table-column prop=\"doneRentalQuantity\" label=\"已完成租用量\" width=\"120\" />\n      <el-table-column prop=\"rentalDays\" label=\"租用时长\" width=\"120\" />\n      <el-table-column prop=\"payDate\" label=\"支付时间\" width=\"180\" :formatter=\"(row) => filterDate(row.payDate)\" />\n      <el-table-column prop=\"delegateDate\" label=\"代理时间\" width=\"180\" :formatter=\"(row) => filterDate(row.delegateDate)\" />\n      <el-table-column prop=\"expiredDate\" label=\"到期时间\" width=\"180\" :formatter=\"(row) => filterDate(row.expiredDate)\" />\n      <el-table-column prop=\"payAmount\" label=\"支付金额\" width=\"120\" />\n      <el-table-column prop=\"orderStatus\" label=\"状态\" width=\"120\" :formatter=\"(row) => filterStatus(row.orderStatus)\" />\n      <el-table-column prop=\"date\" label=\"更多操作\" width=\"220\" fixed=\"right\">\n        <template #default=\"scope\">\n          <el-button link type=\"primary\" size=\"small\" @click=\"details(scope)\">订单详情</el-button>\n          <el-button v-if=\"scope.row.transactionHash\" link type=\"primary\" size=\"small\"\n            @click=\"gotoNew(scope.row.transactionHash)\">代理详情</el-button>\n        </template>\n      </el-table-column>\n    </el-table>\n    <div class=\"sale-record-table-pagination\">\n      <el-pagination v-model:current-page='form.pageIndex' :page-size=\"form.pageSize\" layout=\"prev, pager, next\"\n        :total=\"form.totalCount\" />\n    </div>\n\n    <el-dialog v-model=\"dialogTableVisible\" append-to-body center :title=\"`订单号:${detailsValue.orderNo}`\">\n      <div class=\"custom-modal-centent\">\n        <div class=\"modal-content\">\n          <div class=\"detail\">\n            <div>用户：<span class=\"text\">{{ store.state.userInfo.userInfo.email }}</span></div>\n            <div>\n              钱包地址:\n              <a class=\"jump-a\" target=\"_blank\" :href=\"`https://tronscan.org/#/address/${detailsValue.toAddress}`\">{{\n                store.state.userInfo.userInfo.walletAddress }}</a>\n            </div>\n            <div>\n              <div>TRX余额：<span class=\"text\">{{ store.state.userInfo.userInfo.availableBalance }}</span></div>\n            </div>\n          </div>\n          <div class=\"detail\">\n            <div>\n              交易哈希：\n              <span class=\"text\" style=\"padding: 0px 5px\">{{ detailsValue.transactionHash || '-' }}</span>\n            </div>\n            <div>\n              apiKey：\n              <span class=\"text\" style=\"padding: 0px 5px\">{{ detailsValue.apiKey || '-' }}</span>\n            </div>\n            <div>\n              接收：\n              <a class=\"jump-a\" target=\"_blank\" :href=\"`https://tronscan.org/#/address/${detailsValue.toAddress}`\">{{\n                detailsValue.toAddress }}</a>\n            </div>\n            <div>\n              租用量：<svg class=\"vben-svg-icon\" aria-hidden=\"true\" style=\"width: 16px; height: 16px\">\n                <use xlink:href=\"#icon-seller-selling-energy\"></use>\n              </svg><span class=\"text\">{{ detailsValue.rentalQuantity }}</span>\n            </div>\n            <div>\n              已完成租用量：<svg class=\"vben-svg-icon\" aria-hidden=\"true\" style=\"width: 16px; height: 16px\">\n                <use xlink:href=\"#icon-seller-selling-energy\"></use>\n              </svg><span class=\"text\">{{ detailsValue.doneRentalQuantity }}</span>\n            </div>\n            <div>\n              租用时长：<span class=\"text\">{{ detailsValue.rentalDays }} <span style=\"padding: 0px 2px\">天</span></span>\n            </div>\n            <div>支付金额： <span class=\"text\">{{ detailsValue.payAmount }} TRX</span></div>\n            <div>\n              支付时间：\n              <span class=\"text\">{{ filterDate(detailsValue.payDate) }}</span>\n            </div>\n            <div>\n              代理时间：\n              <span class=\"text\">{{ filterDate(detailsValue.stakeDate) }}</span>\n            </div>\n            <div>\n              到期时间：\n              <span class=\"text\">{{ filterDate(detailsValue.expiredDate) }}</span>\n            </div>\n            <div class=\"flex\">\n              <span>状态：</span>\n              <div style=\"\n                              display: inline-block;\n                              width: fit-content;\n                              padding: 1px 7px;\n                              margin: 0px;\n                              background: rgb(255, 255, 255);\n                              border: 1px solid rgb(191, 191, 191);\n                              border-radius: 3px;\n                              font-size: 12px;\n                              color: rgb(191, 191, 191);\n                            \">\n                {{ filterStatus(detailsValue.orderStatus) }}\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    </el-dialog>\n  </div>\n</template>\n<script setup>\nimport { getRentals, getApiList } from \"@/utils/axios/buyer/index.js\";\nimport { filterDate } from '@/utils/utils/date.js';\nimport { ElMessage } from \"element-plus\";\nconst form = reactive({\n  date: [],\n  orderStatus: \"\",\n  pageIndex: 1,\n  pageSize: 20,\n  totalCount: 0\n});\nconst apiKeyList = ref([]);\nconst store = useStore();\nconst tableData = ref([]);\nconst dialogTableVisible = ref(false);\nconst detailsValue = reactive({});\nconst details = (v) => {\n  Object.assign(detailsValue, v.row);\n  dialogTableVisible.value = true;\n};\nconst gotoNew = (url) => {\n  window.open(`https://tronscan.org/#/transaction/${url}`, '_blank');\n}\n\nconst seach = async () => {\n  if (form.date && form.date.length > 0) {\n    form.startTime = form.date[0]\n    form.endTime = form.date[1]\n  } else {\n    form.date = [];\n  }\n  const data = await getRentals(\"/buyer/user/rentals\", form);\n  if (data.code == 12000) {\n    tableData.value = data.data.data;\n  } else {\n    ElMessage.error(data.mas)\n  }\n\n}\n\nconst filterStatus = (status) => {\n  switch (status) {\n    case \"WAIT_DELEGATE\":\n      return \"等待代理\"\n    case \"DELEGATEING\":\n      return \"代理中\"\n    case \"ALMOST_DONE\":\n      return \"即将结束\"\n    case \"DONE\":\n      return \"已经完成\"\n    case \"UNAVAILABLE\":\n      return \"未生效\"\n    default:\n      return '';\n  }\n}\n\nconst reset = () => {\n  Object.keys(form).map(v => {\n    form[v] = '';\n  })\n  form.date = [];\n\n  seach();\n}\n\n\nonMounted(async () => {\n  seach();\n});\n</script>\n<style scoped>\n.modal-content {}\n\n.text {\n  font-size: 14px;\n  font-family: PingFang SC, PingFang SC-Regular;\n  font-weight: 400;\n  text-align: left;\n  color: #121c41;\n}\n\n.jump-a {\n  color: #294aa5;\n  text-decoration: none;\n  background-color: transparent;\n  outline: none;\n  cursor: pointer;\n  transition: color 0.3s;\n}\n\n.detail {\n  padding: 10px;\n  border: 1px dashed transparent;\n  background: linear-gradient(white, white) padding-box,\n    repeating-linear-gradient(-45deg, #ccc 0, #ccc 0.3em, white 0, white 0.5em);\n}\n\n.detail div {\n  margin: 0.4em 0;\n}\n\n.test {\n  display: flex;\n  flex-direction: column;\n}\n\n.sale-record {\n  width: 100%;\n  box-sizing: border-box;\n  background: white;\n  border: 1px solid #c8d0df !important;\n  border-radius: 2px;\n}\n\n.sale-record-search {\n  padding: 12px 10px;\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n  margin-bottom: 16px;\n}\n\n.sale-record-table {\n  height: 85%;\n  padding: 6px;\n}\n\n.sale-record-group {\n  margin-bottom: 14px;\n}\n\n.sale-record-table-list {}\n\n.sale-record-table-pagination {\n  margin-top: 10px;\n  width: 100%;\n}\n</style>\n"],"names":["form","reactive","ref","store","useStore","tableData","dialogTableVisible","detailsValue","details","v","gotoNew","url","seach","data","getRentals","ElMessage","filterStatus","status","reset","onMounted"],"mappings":"q4EAsIA,MAAAA,EAAAC,EAAA,CACA,KAAA,CAAA,EACA,YAAA,GACA,UAAA,EACA,SAAA,GACA,WAAA,CACA,CAAA,EACAC,EAAA,EAAA,EACA,MAAAC,EAAAC,EAAA,EACAC,EAAAH,EAAA,CAAA,CAAA,EACAI,EAAAJ,EAAA,EAAA,EACAK,EAAAN,EAAA,CAAA,CAAA,EACAO,EAAAC,GAAA,CACA,OAAA,OAAAF,EAAAE,EAAA,GAAA,EACAH,EAAA,MAAA,EACA,EACAI,EAAAC,GAAA,CACA,OAAA,KAAA,sCAAAA,IAAA,QAAA,CACA,EAEAC,EAAA,SAAA,CACAZ,EAAA,MAAAA,EAAA,KAAA,OAAA,GACAA,EAAA,UAAAA,EAAA,KAAA,GACAA,EAAA,QAAAA,EAAA,KAAA,IAEAA,EAAA,KAAA,GAEA,MAAAa,EAAA,MAAAC,EAAA,sBAAAd,CAAA,EACAa,EAAA,MAAA,KACAR,EAAA,MAAAQ,EAAA,KAAA,KAEAE,EAAA,MAAAF,EAAA,GAAA,CAGA,EAEAG,EAAAC,GAAA,CACA,OAAAA,EAAA,CACA,IAAA,gBACA,MAAA,2BACA,IAAA,cACA,MAAA,qBACA,IAAA,cACA,MAAA,2BACA,IAAA,OACA,MAAA,2BACA,IAAA,cACA,MAAA,qBACA,QACA,MAAA,EACA,CACA,EAEAC,EAAA,IAAA,CACA,OAAA,KAAAlB,CAAA,EAAA,IAAAS,GAAA,CACAT,EAAAS,GAAA,EACA,CAAA,EACAT,EAAA,KAAA,GAEAY,GACA,EAGA,OAAAO,EAAA,SAAA,CACAP,GACA,CAAA"}